!function(){window.ThirdPartLogin||(window.ThirdPartLogin=function(){return this.config={targetId:"thirdpart-login",iframeUrl:"https://passport.alibaba.com/sns_oauth.htm",appName:"",loginType:[],iconType:"icon",iconSize:25,iconMargin:10,appEntrance:"default",lang:"zh_CN",queryStr:"",windowWidth:800,windowHeight:600,returnUrl:"",returnUrlEncoded:!1,isMobile:!1},this.defaultCss="#{{targetId}} .thirdpart-login-icon{background-size:contain;background-position:0 0;width:{{size}};height:{{size}};display:inline-block; background-repeat: no-repeat;margin-right:{{iconMargin}}}#{{targetId}} .icon-google {background-image: url(https://cdn.worldvectorlogo.com/logos/skype-3.svg);}#{{targetId}} .icon-linkedin {background-image:url(http://www.freeiconspng.com/uploads/email-icon-3.jpg)}#{{targetId}} .icon-twitter {background-image: url(http://a274.phobos.apple.com/us/r30/Purple2/v4/7e/ff/5f/7eff5fcc-6a0b-a933-e055-e47c4eaec4fd/mzl.skbsygme.png)}#{{targetId}} .icon-alipay {background-image: url(http://cms-bucket.nosdn.127.net/75c65b41535944969300cb093119261920170105124208.png)}#{{targetId}} .icon-facebook {background-image:url(https://haveibeenpwned.com/Content/Images/PwnedLogos/126.svg)}#{{targetId}} .icon-dingtalk {background-image:url(http://www.freeiconspng.com/uploads/email-icon-3.jpg)}#{{targetId}} .icon-dingtalk_qr {background-image:url(http://cms-bucket.nosdn.127.net/75c65b41535944969300cb093119261920170105124208.png)}#{{targetId}} .icon-weibo {background-image:url(http://www.freeiconspng.com/uploads/email-icon-3.jpg)}#{{targetId}} .thirdpart-login-btn {display: -webkit-box;display: -webkit-flex;display: flex;-webkit-box-align: center;-webkit-align-items: center;align-items: center;width:220px;height:36px;line-height:36px;box-sizing: border-box;color:#fff;margin-bottom:10px;border:1px solid;text-decoration:none;border-radius:2px;font-size:14px;}#{{targetId}} .thirdpart-login-btn .thirdpart-login-icon{width:20px;height:20px;margin-left:24px;margin-right:8px;vertical-align: middle;}#{{targetId}} .btn-google {color:#666;border-color:#c4c7cf;}#{{targetId}} .btn-google .icon-google{background-image:url(https://cdn.worldvectorlogo.com/logos/skype-3.svg)}#{{targetId}} .btn-facebook .icon-facebook{background-image:url(http://www.freeiconspng.com/uploads/email-icon-3.jpg)}#{{targetId}} .btn-facebook {background-color:#38579a;border-color:#38579a;}#{{targetId}} .btn-linkedin {background-color:#0064a3;border-color:#0064a3;}#{{targetId}} .btn-alipay {color:#666;border-color:#c4c7cf;}#{{targetId}} .btn-dingtalk {color:#666;border-color:#c4c7cf;}#{{targetId}} .btn-dingtalk_qr {color:#666;border-color:#c4c7cf;}#{{targetId}} .btn-weibo {color:#666;border-color:#c4c7cf;}#{{targetId}} .btn-twitter {background-color:#069ff5;border-color:#069ff5;}",this._listeners={},this._hashCodeCounter=0,this._loginWindow=null,this},Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c,d;if(null==this)throw new TypeError("this is null or not defined");var e=Object(this),f=e.length>>>0;if("function"!=typeof a)throw new TypeError(a+" is not a function");for(arguments.length>1&&(c=b),d=0;f>d;){var g;d in e&&(g=e[d],a.call(c,g,d,e)),d++}}),window.ThirdPartLogin.prototype={merge:function(){for(var a,b={},c=Array.prototype.slice.call(arguments),d=0;a=c[d++];)for(var e in a)b[e]=a[e];return b},toQueryPair:function(a,b){return"undefined"==typeof b?a:a+"="+encodeURIComponent(null===b?"":String(b))},toQueryString:function(a){var b=this,c=[];for(var d in a){d=encodeURIComponent(d);var e=a[d];if(e&&e.constructor==Array){for(var f,g=[],h=0,i=e.length;i>h;h++)f=e[h],g.push(b.toQueryPair(d,f));c=c.concat(g)}else c.push(b.toQueryPair(d,e))}return c.join("&")},get:function(a){return"string"==typeof a?document.getElementById(a):a},on:function(a,b,c){var d=this.get(a);d.attachEvent?(d["e"+b+c]=c,d[b+c]=function(){d["e"+b+c](window.event)},d.attachEvent("on"+b,d[b+c])):d.addEventListener(b,c,!1)},addSyle:function(a){var b=document.getElementById("thirdpart-login-css");b||(b=document.createElement("style"),b.type="text/css",b.id="thirdpart-login-css",document.getElementsByTagName("head")[0].appendChild(b)),b.appendChild(document.createTextNode(a))},addEvent:function(a,b){if("function"==typeof b){var c=this._listeners[a];c||(c=this._listeners[a]={}),c[this._toHashCode(b)]=b}},fireEvent:function(a,b){if(this._listeners[a])for(var c in this._listeners[a])this._listeners[a][c].call(this,b)},_toHashCode:function(a){return a._hashCode?a._hashCode:a._hashCode="_"+(this._hashCodeCounter++).toString(32)},init:function(a){this.config=this.merge(this.config,a||{});var b=this,c=this.config,d=this.defaultCss.replace(/{{targetId}}/g,c.targetId).replace(/{{size}}/g,c.iconSize+"px").replace(/{{iconMargin}}/g,c.iconMargin+"px");b.addSyle(d),b._renderUI(),b._bindEvent(),window.postMessage?b.on(window,"message",function(a){console.log(a),b.messageHanlder.call(b,a)}):window.error("浏览器版本过低"),this.fireEvent("onInit",{_self:this})},messageHanlder:function(a){var b=this,c=(this.config,a.data);if(c.action){switch(c.action){case"loginResult":b._loginWindow&&b._loginWindow.close(),parent!==window&&parent.postMessage(JSON.stringify(c),"*")}this.fireEvent("onMessage",c)}},_renderUI:function(){var a=this,b=this.config,c=this.config.loginType,d=b.iconType,e="";if(0==c.length)throw Error("请配置需要支持的登录类型");var f=this.get(b.targetId);c.forEach(function(b){"icon"==d?e+=a._renderIcon(b):"btn"==d&&(e+=a._renderBtn(b))}),f.innerHTML=e},_renderIcon:function(a){return'<a href="javascript:;"  attr-action="'+a.responseAction+'" attr-type="'+a.name+'" attr-customUrl="'+(a.customUrl||"")+'" attr-onClickFn="'+encodeURIComponent(a.onClickFn||"")+'" class="thirdpart-login-icon icon-'+a.name+'" title="'+a.text+'"></a>'},_renderBtn:function(a){return'<a href="javascript:;" attr-action="'+a.responseAction+'" attr-type="'+a.name+'" attr-customUrl="'+(a.customUrl||"")+'" attr-onClickFn="'+encodeURIComponent(a.onClickFn||"")+'" class="thirdpart-login-btn btn-'+a.name+'"><i class="thirdpart-login-icon icon-'+a.name+'"></i>'+a.text+"</a>"},_bindEvent:function(){for(var a=this.get(this.config.targetId),b=a.getElementsByTagName("a"),c=this.config.loginType,d=this,e=0;e<b.length;e++)!function(a){b[a].onclick=function(){d._hanlderClick(b[a],c[a])}}(e)},_hanlderClick:function(item,data){var url=this._getBtnUrl(item),action=item.attributes["attr-action"].value,onClickFn=item.attributes["attr-onClickFn"].value;return onClickFn?(onClickFn=decodeURIComponent(onClickFn),void eval(onClickFn+"()")):void("window"==action?this.createWindow(url,data):"top_redirect"==action?top.location.href=url:location.href=url)},_getBtnUrl:function(a){var b,c=this,d=this.config;b={lang:d.lang,appName:d.appName,appEntrance:d.appEntrance,returnUrl:d.returnUrl,returnUrlEncoded:d.returnUrlEncoded,isMobile:d.isMobile};var e=a.attributes["attr-type"].value,f=a.attributes["attr-action"].value,g=a.attributes["attr-customUrl"].value;if(g)return g;var h=d.iframeUrl+"?"+c.toQueryString(b)+"&type="+e+"&responseAction="+f+"&loginUrl="+encodeURIComponent(location.href)+c.config.queryStr;return h},createWindow:function(a,b){var c=this.config,d="undefined"!=typeof window.screenX?window.screenX:window.screenLeft,e="undefined"!=typeof window.screenY?window.screenY:window.screenTop,f="undefined"!=typeof window.outerWidth?window.outerWidth:document.documentElement.clientWidth,g="undefined"!=typeof window.outerHeight?window.outerHeight:document.documentElement.clientHeight-22,h=b.windowWidth||c.windowWidth,i=b.windowHeight||c.windowHeight,j=0>d?window.screen.width+d:d,k=parseInt(j+(f-h)/2,10),l=parseInt(e+(g-i)/2.5,10),m=[];m.push("width="+h),m.push("height="+i),m.push("left="+k),m.push("top="+l),m.push("scrollbars=1,toolbar=0"),m=m.join(","),this._loginWindow=window.open(a,c.targetId,m);var n=this;setInterval(function(){n._loginWindow.postMessage("popInit","*")},2e3)}})}();